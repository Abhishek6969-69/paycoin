(()=>{var e={};e.id=688,e.ids=[688],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},55315:e=>{"use strict";e.exports=require("path")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},38037:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),a(31826),a(68032),a(35866),a(94034);var s=a(23191),t=a(88716),i=a(37922),l=a.n(i),n=a(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(r,o);let d=["",{children:["(dashboard)",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,31826)),"/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/(dashboard)/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,68032)),"/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,94034)),"/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/(dashboard)/profile/page.tsx"],u="/(dashboard)/profile/page",p={require:a,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/(dashboard)/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},40449:(e,r,a)=>{let s={b50eb04b0437b30a11f925bfa8d45272dd05b272:()=>Promise.resolve().then(a.bind(a,61281)).then(e=>e.default)};async function t(e,...r){return(await s[e]()).apply(null,r)}e.exports={b50eb04b0437b30a11f925bfa8d45272dd05b272:t.bind(null,"b50eb04b0437b30a11f925bfa8d45272dd05b272")}},88920:(e,r,a)=>{Promise.resolve().then(a.bind(a,75354))},75354:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>c});var s=a(10326),t=a(17577),i=a(11695),l=a(46226),n=a(554);function o({userData:e,onClose:r,onProfileUpdate:a}){let{data:o}=(0,i.useSession)(),[d,c]=(0,t.useState)(null),[u,p]=(0,t.useState)(!1),m=async()=>{if(!d){alert("Please select an image to upload!");return}p(!0);try{let e=new FormData;e.append("image",d),e.append("userId",String(o?.user?.id||""));let s=await fetch("/api/upload",{method:"POST",body:e}),t=await s.json();s.ok?(a(t.imageUrl),alert("Image uploaded successfully!"),r()):(console.error("Upload failed:",t.error),alert("Upload failed: "+(t.error||"Unknown error")))}catch(e){console.error("Upload error:",e),alert("An error occurred during upload")}finally{p(!1)}};return(0,s.jsxs)("div",{className:"space-y-6 bg-[#121212] p-6 rounded-lg shadow-md border border-gray-700",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[e?.profileImage?s.jsx(l.default,{className:"w-[100px] h-[100px] rounded-full object-cover border-2 border-gray-500",src:e.profileImage,width:100,height:100,alt:"User Photo"}):s.jsx("div",{className:"w-[100px] h-[100px] rounded-full bg-gray-800 flex items-center justify-center border border-gray-600",children:s.jsx("span",{className:"text-4xl text-gray-500",children:"\uD83D\uDC64"})}),(0,s.jsxs)("label",{className:"mt-4 cursor-pointer",children:[s.jsx("div",{className:"bg-gray-700 text-gray-200 hover:bg-gray-600 px-4 py-2 rounded-md text-sm font-medium transition-all",children:"Choose Photo"}),s.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{let r=e.target.files?.[0];r&&c(r)}})]}),d&&(0,s.jsxs)("p",{className:"mt-2 text-sm text-gray-400",children:["Selected: ",d.name]})]}),(0,s.jsxs)("div",{className:"flex  ml-10 space-x-2",children:[s.jsx(n.z,{type:"button",onClick:r,className:"bg-gray-700 hover:bg-gray-600 text-gray-200 border border-gray-500",children:"Cancel"}),s.jsx(n.z,{onClick:m,type:"submit",className:"bg-blue-600 hover:bg-blue-500 text-white border border-blue-500",children:u?"Uploading...":"Upload Photo"})]})]})}var d=a(33431);function c(){let[e,r]=(0,t.useState)(null),[a,c]=(0,t.useState)(!1),[u,p]=(0,t.useState)(!0),{data:m}=(0,i.useSession)(),x=()=>c(!1);return u?s.jsx("div",{className:"max-w-4xl mx-auto p-6 flex justify-center items-center min-h-[60vh]",children:(0,s.jsxs)("div",{className:"animate-pulse flex flex-col items-center",children:[s.jsx("div",{className:"rounded-full bg-gray-200 h-32 w-32 mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-48 mb-4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-64"})]})}):(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[a&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-card rounded-lg p-6 w-full max-w-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Edit Profile"}),s.jsx("button",{onClick:x,className:"text-gray-500 hover:text-gray-700","aria-label":"Close",children:"âœ•"})]}),s.jsx(o,{onClose:x,userData:e,onProfileUpdate:e=>{r(r=>({...r,profileImage:e}))}})]})}),s.jsx(d.Z,{title:"User Profile",className:"w-full md:w-[600px] mx-auto mt-8 p-8 shadow-lg hover:shadow-xl transition-shadow duration-300",children:(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[e?.profileImage?(0,s.jsxs)("div",{className:"relative group",children:[s.jsx(l.default,{className:"rounded-full w-[200px] h-[200px] border-4 border-primary/20 hover:border-primary/60 transition-all duration-300 shadow-lg",src:e.profileImage,alt:"User profile",width:200,height:200,priority:!0}),s.jsx("div",{className:"absolute inset-0 rounded-full bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}):s.jsx("div",{className:"w-[200px] h-[200px] rounded-full bg-gray-200 flex items-center justify-center",children:s.jsx("span",{className:"text-4xl text-gray-400",children:"\uD83D\uDC64"})}),s.jsx("div",{className:"mt-6",children:s.jsx(n.z,{onClick:()=>c(!0),className:"px-6",type:"submit",children:"Edit Profile"})})]}),(0,s.jsxs)("div",{className:"space-y-6 px-4",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[s.jsx("label",{className:"text-sm text-muted-foreground uppercase tracking-wider",children:"Name"}),s.jsx("h1",{className:"text-2xl font-semibold",children:e?.name||"User"})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[s.jsx("label",{className:"text-sm text-muted-foreground uppercase tracking-wider",children:"Email"}),s.jsx("h1",{className:"text-2xl font-semibold",children:e?.email||m?.user?.email||"N/A"})]})]})]})})]})}a(59611)},59611:(e,r,a)=>{"use strict";a.d(r,{Z:()=>s}),a(15424);let s=(0,a(46242).$)("b50eb04b0437b30a11f925bfa8d45272dd05b272")},31826:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>s});let s=(0,a(68570).createProxy)(String.raw`/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/(dashboard)/profile/page.tsx#default`)},24259:(e,r,a)=>{"use strict";a.d(r,{L:()=>n});var s=a(16920),t=a(12495),i=a(40038),l=a.n(i);let n={providers:[(0,t.Z)({name:"Credentials",credentials:{name:{label:"Name",type:"text",placeholder:"your name",required:!0},phone:{label:"Phone number",type:"text",placeholder:"1231231231",required:!0},password:{label:"Password",type:"password",required:!0}},async authorize(e){let r=await l().hash(e.password,10),a=await s.Z.user.findFirst({where:{number:e.phone}});if(a)return await l().compare(e.password,a.password)?(console.log(a.name),{id:a.id.toString(),name:a.name,email:a.number}):null;try{let a=await s.Z.user.create({data:{name:e.name,number:e.phone,password:r}});return{id:a.id.toString(),name:a.name,email:a.number}}catch(e){await s.Z.$disconnect(),console.error(e)}return null}})],secret:process.env.JWT_SECRET||"secret",callbacks:{jwt:async({token:e,user:r})=>(r&&(e.name=r.name||e.name,e.email=r.email||e.email),e),async session({token:e,session:r}){r.user.id=e.sub,r.user.token=e.jti,r.user.name=e.name||r.user.name,r.user.email=e.email||r.user.email;try{await s.Z.balance.upsert({where:{userId:Number(r.user.id)},update:{},create:{userId:Number(r.user.id),amount:Number(1e6*Math.random()),locked:0}})}catch(e){await s.Z.$disconnect()}finally{}return r}},pages:{signIn:"/user/signin"}}},61281:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>n});var s=a(27745);a(26461);var t=a(16920),i=a(19031),l=a(24259);async function n(){let e=await (0,i.getServerSession)(l.L);return await t.Z.user.findUnique({where:{id:Number(e?.user?.id)}})}(0,a(85723).h)([n]),(0,s.j)("b50eb04b0437b30a11f925bfa8d45272dd05b272",n)},16920:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});var s=a(53524);let t=globalThis.prismaGlobal??new s.PrismaClient}};var r=require("../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),s=r.X(0,[948,865,621,43,362,207,226,40],()=>a(38037));module.exports=s})();