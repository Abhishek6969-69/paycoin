(()=>{var e={};e.id=300,e.ids=[300],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},55315:e=>{"use strict";e.exports=require("path")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},32049:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(21589),s(68032),s(35866),s(94034);var t=s(23191),r=s(88716),n=s(37922),i=s.n(n),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(a,o);let d=["",{children:["(dashboard)",{children:["transactions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,21589)),"/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/(dashboard)/transactions/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,68032)),"/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,94034)),"/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/abhishekyadav/Desktop/coinpay/apps/user-app/app/(dashboard)/transactions/page.tsx"],u="/(dashboard)/transactions/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(dashboard)/transactions/page",pathname:"/transactions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},89665:(e,a,s)=>{let t={"9132cad5f07212d18ba7dac84a861a817cc79727":()=>Promise.resolve().then(s.bind(s,87888)).then(e=>e.default)};async function r(e,...a){return(await t[e]()).apply(null,a)}e.exports={"9132cad5f07212d18ba7dac84a861a817cc79727":r.bind(null,"9132cad5f07212d18ba7dac84a861a817cc79727")}},96917:(e,a,s)=>{Promise.resolve().then(s.bind(s,95369)),Promise.resolve().then(s.bind(s,27556)),Promise.resolve().then(s.bind(s,14472))},95369:(e,a,s)=>{"use strict";s.d(a,{default:()=>m});var t=s(10326),r=s(17577),n=s(33431),i=s(6363),l=s(554);s(15424);let o=(0,s(46242).$)("9132cad5f07212d18ba7dac84a861a817cc79727");var d=s(43007),c=s(67829),u=s(52297);function m(){let e=[{name:"HDFC",redirecturl:"https://netbanking.hdfcbank.com/netbanking/"},{name:"KOTAK",redirecturl:"https://netbanking.kotak.com/knb2/"},{name:"State Bank of India",redirecturl:"https://netbanking.kotak.com/knb2/"}],[a,s]=(0,r.useState)(e[0]?.redirecturl),[m,p]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[b,g]=(0,r.useState)(e[0]?.name||""),y=async()=>{if(!m||!b){u.Am.error("Please fill in all fields!");return}let e=Number(m);if(!m||isNaN(e)||e<=0){u.Am.error("Please fill in valid  positive value!");return}let a=u.Am.loading("Processing your request...");try{let e=await o({amount:m,provider:b});e&&e.token&&(h(e.token),u.Am.dismiss(a),u.Am.success("Redirecting to bank server for payment approval..."),window.location.href=e.redirectUrl)}catch(e){u.Am.dismiss(a),u.Am.error("An error occurred. Please try again."),console.error("Transfer failed:",e)}};return t.jsx(n.Z,{title:"Add Money",className:"w-full shadow-sm bg-white border border-gray-200",children:(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(d._,{label:"Amount",className:"text-sm font-medium text-gray-700"}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium",children:"₹"}),t.jsx(i.Z,{placeholder:"Enter amount",type:"number",className:"w-full pl-8 bg-white border-gray-300 focus:border-blue-500 focus:ring focus:ring-blue-500/20 rounded-lg transition-all",onChange:e=>p(e)})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(d._,{label:"Select Bank",className:"text-sm font-medium text-gray-700"}),t.jsx(c.Z,{onselect:a=>{let t=e.find(e=>e.name===a);s(t?.redirecturl||""),g(t?.name||"")},options:e.map(e=>({key:e.name,value:e.name}))})]}),t.jsx(l.z,{type:"submit",variant:"primary",size:"lg",className:"w-full",onClick:y,children:"Add Money"})]})})}},27556:(e,a,s)=>{"use strict";s.d(a,{OnRampTransactions:()=>i});var t=s(10326),r=s(33431),n=s(17577);let i=({transactions:e})=>{let[a,s]=(0,n.useState)(e);(0,n.useEffect)(()=>{let e=setInterval(()=>{let e=new Date().getTime();s(a.map(a=>"Processing"===a.status&&(e-new Date(a.time).getTime())/6e4>1440?{...a,status:"Failed"}:a))},1e4);return()=>clearInterval(e)},[a]);let i=[...a].sort((e,a)=>a.time.getTime()-e.time.getTime()).slice(0,10);return i.length?t.jsx(r.Z,{title:"Recent Transactions",className:"border border-gray-200 bg-white shadow-sm h-[400px] overflow-hidden",children:t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"max-h-[300px] overflow-y-auto space-y-4",children:i.map((e,a)=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-4 border border-gray-100 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Received INR"}),t.jsx("div",{className:"text-gray-500 text-xs mt-1",children:new Date(e.time).toDateString()})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${"Success"===e.status?"bg-green-100 text-green-800":"Processing"===e.status?"bg-yellow-100 text-yellow-800":"Failed"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:e.status}),(0,t.jsxs)("span",{className:"text-green-600 font-semibold",children:["+ ₹",(e.amount/100).toFixed(2)]})]})]},a))})})}):t.jsx(r.Z,{title:"Recent Transactions",className:"border border-gray-200 bg-white shadow-sm",children:(0,t.jsxs)("div",{className:"p-12 text-center",children:[t.jsx("div",{className:"text-gray-400 mb-2",children:t.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),t.jsx("p",{className:"text-gray-500 text-sm",children:"No transactions yet"}),t.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Your transactions will appear here"})]})})}},14472:(e,a,s)=>{"use strict";s.d(a,{default:()=>i});var t=s(10326),r=s(35047),n=s(17577);function i(){(0,r.useSearchParams)();let[e,a]=(0,n.useState)(null),[s,i]=(0,n.useState)(!1);return s?e:t.jsx("div",{className:"h-4"})}},6363:(e,a,s)=>{"use strict";s.d(a,{Z:()=>r});var t=s(10326);function r({placeholder:e,onChange:a,type:s,className:r,maxlength:n}){return t.jsx("div",{className:" ",children:t.jsx("input",{maxLength:n,className:`border  px-4 py-2  rounded    ${r}`,type:s,placeholder:e,onChange:e=>a(e.target.value)})})}s(17577)},43007:(e,a,s)=>{"use strict";s.d(a,{_:()=>r});var t=s(10326);function r({label:e,className:a}){return t.jsx("label",{className:`block ml-2  mt-2 mb-1   ${a}`,children:e})}s(17577)},67829:(e,a,s)=>{"use strict";s.d(a,{Z:()=>r});var t=s(10326);function r({onselect:e,options:a,className:s}){return t.jsx("div",{className:`w-full ${s}`,children:t.jsx("select",{className:"w-full text-gray-500 px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:a=>{e(a.target.value)},children:a.map(e=>t.jsx("option",{value:e.key,children:e.value},e.key))})})}},21589:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>g,dynamic:()=>x});var t=s(19510),r=s(4057),n=s(68570);let i=(0,n.createProxy)(String.raw`/Users/abhishekyadav/Desktop/coinpay/apps/user-app/components/Addmoney.tsx#default`),l=(0,n.createProxy)(String.raw`/Users/abhishekyadav/Desktop/coinpay/apps/user-app/components/Onramptransaction.tsx#OnRampTransactions`);var o=s(67538);let d=({amount:e,locked:a})=>t.jsx(o.Z,{title:"Balance",className:"border border-gray-200 bg-white shadow-sm",children:(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center py-3 border-b border-gray-100",children:[t.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Available Balance"}),(0,t.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:["₹",Math.max(0,e/100).toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-3 border-b border-gray-100",children:[t.jsx("div",{className:"text-sm font-medium text-gray-600",children:"Locked Balance"}),(0,t.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:["₹",Math.max(0,a/100).toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center py-3 bg-blue-50 -mx-6 px-6 rounded-lg",children:[t.jsx("div",{className:"text-sm font-semibold text-blue-900",children:"Total Balance"}),(0,t.jsxs)("div",{className:"text-xl font-bold text-blue-900",children:["₹",Math.max(0,(a+e)/100).toFixed(2)]})]})]})});var c=s(17413),u=s(95306);let m=(0,n.createProxy)(String.raw`/Users/abhishekyadav/Desktop/coinpay/apps/user-app/components/TransactionStatus.tsx#default`);var p=s(71159);let x="force-dynamic";async function h(){let e=await (0,c.getServerSession)(u.L);if(!e)return{amount:0,locked:0};try{let a=await r.Z.balance.upsert({where:{userId:Number(e?.user?.id)},update:{},create:{userId:Number(e?.user?.id),amount:0,locked:0}});return{amount:Math.max(0,a?.amount||0),locked:Math.max(0,a?.locked||0)}}catch(e){return console.error("Error fetching balance:",e),{amount:0,locked:0}}finally{await r.Z.$disconnect()}}async function b(){let e=await (0,c.getServerSession)(u.L);return e?.user?.id?(await r.Z.onRampTransaction.findMany({where:{userId:Number(e?.user?.id)}})).map(e=>({key:e.id,time:e.startTime,amount:e.amount,status:e.status,provider:e.provider})):[]}async function g(){try{let e=await h(),a=await b();return t.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto space-y-8",children:[t.jsx(p.Suspense,{fallback:t.jsx("div",{className:"h-4"}),children:t.jsx(m,{})}),t.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 p-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-3",children:"Transactions"}),t.jsx("p",{className:"text-lg text-gray-600",children:"Manage your wallet and view transaction history"})]}),(0,t.jsxs)("div",{className:"hidden md:flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Total Transactions"}),t.jsx("p",{className:"text-2xl font-bold text-green-600",children:a.length})]}),t.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-50 to-green-100 rounded-2xl flex items-center justify-center border border-green-200",children:t.jsx("span",{className:"text-2xl",children:"\uD83D\uDCB3"})})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-2",children:[t.jsx("div",{className:"space-y-8",children:t.jsx(i,{})}),(0,t.jsxs)("div",{className:"space-y-8",children:[t.jsx(d,{amount:e?.amount||0,locked:e?.locked||0}),t.jsx(l,{transactions:a})]})]})]})})}catch(e){return console.error("Error in transactions page:",e),t.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:t.jsx("div",{className:"max-w-7xl mx-auto",children:(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-8",children:[t.jsx("h1",{className:"text-red-800 font-semibold text-xl mb-2",children:"Error Loading Transactions"}),t.jsx("p",{className:"text-red-700",children:"Unable to load the transactions page. Please try refreshing the page."}),(0,t.jsxs)("p",{className:"text-red-600 text-sm mt-2",children:["Error details: ",e instanceof Error?e.message:"Unknown error"]})]})})})}}},87888:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>l});var t=s(27745);s(26461);var r=s(19031),n=s(24259),i=s(16920);async function l({amount:e,provider:a}){let s=await (0,r.getServerSession)(n.L);if(!s){console.error("❌ No session found. User might not be logged in.");return}let t=Number(s?.user?.id),l=Math.random().toString();await i.Z.onRampTransaction.create({data:{userId:t,amount:100*Number(e),startTime:new Date,token:l,provider:a,status:"Processing",type:"DEPOSIT"}});let o=100*Number(e),d=`http://localhost:3004/start-payment?token=${l}&amount=${o}&user_identifier=${t}`;return{token:l,redirectUrl:d}}(0,s(85723).h)([l]),(0,t.j)("9132cad5f07212d18ba7dac84a861a817cc79727",l)},24259:(e,a,s)=>{"use strict";s.d(a,{L:()=>l});var t=s(16920),r=s(12495),n=s(40038),i=s.n(n);let l={providers:[(0,r.Z)({name:"Credentials",credentials:{name:{label:"Name",type:"text",placeholder:"your name",required:!0},phone:{label:"Phone number",type:"tel",maxlength:"10",placeholder:"1231231231",required:!0},password:{label:"Password",type:"password",required:!0}},async authorize(e){let a=await i().hash(e.password,10),s=await t.Z.user.findFirst({where:{number:e.phone}});if(s)return await i().compare(e.password,s.password)?{id:s.id.toString(),name:s.name,email:s.number}:null;try{let s=await t.Z.user.create({data:{name:e.name,number:e.phone,password:a}});return{id:s.id.toString(),name:s.name,email:s.number}}catch(e){await t.Z.$disconnect(),console.error(e)}return null}})],secret:process.env.JWT_SECRET||"secret",callbacks:{jwt:async({token:e,user:a})=>(a&&(e.name=a.name||e.name,e.email=a.email||e.email),e),async session({token:e,session:a}){a.user.id=e.sub,a.user.token=e.jti,a.user.name=e.name||a.user.name,a.user.email=e.email||a.user.email;try{await t.Z.balance.upsert({where:{userId:Number(a.user.id)},update:{},create:{userId:Number(a.user.id),amount:0,locked:0}})}catch(e){await t.Z.$disconnect()}finally{}return a}},pages:{signIn:"/user/signin"}}},95306:(e,a,s)=>{"use strict";s.d(a,{L:()=>l});var t=s(4057),r=s(53152),n=s(13085),i=s.n(n);let l={providers:[(0,r.Z)({name:"Credentials",credentials:{name:{label:"Name",type:"text",placeholder:"your name",required:!0},phone:{label:"Phone number",type:"tel",maxlength:"10",placeholder:"1231231231",required:!0},password:{label:"Password",type:"password",required:!0}},async authorize(e){let a=await i().hash(e.password,10),s=await t.Z.user.findFirst({where:{number:e.phone}});if(s)return await i().compare(e.password,s.password)?{id:s.id.toString(),name:s.name,email:s.number}:null;try{let s=await t.Z.user.create({data:{name:e.name,number:e.phone,password:a}});return{id:s.id.toString(),name:s.name,email:s.number}}catch(e){await t.Z.$disconnect(),console.error(e)}return null}})],secret:process.env.JWT_SECRET||"secret",callbacks:{jwt:async({token:e,user:a})=>(a&&(e.name=a.name||e.name,e.email=a.email||e.email),e),async session({token:e,session:a}){a.user.id=e.sub,a.user.token=e.jti,a.user.name=e.name||a.user.name,a.user.email=e.email||a.user.email;try{await t.Z.balance.upsert({where:{userId:Number(a.user.id)},update:{},create:{userId:Number(a.user.id),amount:0,locked:0}})}catch(e){await t.Z.$disconnect()}finally{}return a}},pages:{signIn:"/user/signin"}}},16920:(e,a,s)=>{"use strict";s.d(a,{Z:()=>r});var t=s(53524);let r=globalThis.prismaGlobal??new t.PrismaClient},4057:(e,a,s)=>{"use strict";s.d(a,{Z:()=>r});var t=s(53524);let r=globalThis.prismaGlobal??new t.PrismaClient},67538:(e,a,s)=>{"use strict";s.d(a,{Z:()=>r});var t=s(19510);function r({title:e,children:a,className:s}){return(0,t.jsxs)("div",{className:`rounded-lg bg-white text-gray-900 ${s}`,children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:e})}),t.jsx("div",{children:a})]})}}};var a=require("../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[948,865,621,43,413,197,85,207,40],()=>s(32049));module.exports=t})();